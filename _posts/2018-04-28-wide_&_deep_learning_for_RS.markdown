---
layout:     post
title:      Wide & Deep Learning for Recommender Systems
date:       2018-04-28 00:00:00
author:     Google Inc.
categories: Data-Science
---  
  
  
**Heng-Tze Cheng, Levent Koc, Jeremiah Harmsen, Tal Shaked, Tushar Chandra,Hrishi Aradhye, Glen Anderson, Greg Corrado, Wei Chai, Mustafa Ispir, Rohan Anil,Zakaria Haque, Lichan Hong, Vihan Jain, Xiaobing Liu, Hemal Shah의 [*Wide & Deep Learning for Recommender Systems*](https://arxiv.org/pdf/1606.07792v1.pdf)을 번역했습니다.**
  
  
- - -
  
## 초록
  
비선형 변수 변환을 적용한 일반화 선형 모형은 입력값이 희소한 대규모 회귀 분석 및 분류 문제에 널리 사용된다. *광범위한* 교차곱 변수 변환을 통한 변수의 교호 작용 암기는 효과적이고 해석하긴 쉽지만 일반화를 위해서 피쳐 엔지니어링에 더 많은 노력이 필요하다. 적은 피쳐 엔지니어링으로 *심층* 신경망은 희소한 변수에 대해 학습한 저차원 임베딩을 통해 눈에 보이지 않는 변수 조합에 대한 일반화를 보다 잘 할 수 있다. 그러나 임베딩을 통한 심층 신경망은 사용자 - 항목 교호 작용이 희소하고 계수가 높을 때 지나치게 일반화되어 크게 관련없는 항목을 추천할 수 있다. 이 논문은 추천 시스템에 암기와 일반화 이점을 결합하기 위해 Wide & Deep 학습, 즉 함께 훈련시킨 광범위한 선형 모형 및 심층 신경망를 제시한다. Google은 10억 명이 넘는 활성 사용자와 100만 개가 넘는 앱을 보유한 상용 모바일 앱 스토어 Google Play에 시스템을 구축하고 평가했다. 온라인 실험 결과에 따르면 Wide & Deep은 광범위한 선형 모형만 사용한 것과 심층 신경망만 사용한 것 대비해서 앱 가입을 크게 증가시켰다. 우린 또한 TensorFlow에 오픈소스를 구현해놨다.
  
## 1. 개론
  
추천 시스템은 사용자 및 맥락 정보의 집합이 입력 질의이고 품목마다 순위가 매겨진 목록이 출력인 검색 질의 시스템 일종으로 볼 수 있다. 추천 업무는 질의문이 주어졌을 때 데이터베이스에서 관련 품목을 찾고 클릭 또는 구매 같은 특정 목표에 기반하여 품목의 순위를 매기는 것이다.
  
추천 검색 시스템의 한 가지 난점은 일반적인 검색 순위 문제와 마찬가지로 *암기*와 *일반화*를 모두 이뤄내는 것이다. 암기는 동시에 빈발하는 품목 또는 특성을 학습하고 과거 내역에서 이용가능한 상관 관계를 뽑아내 대략적인 정의를 내린다. 한편, 일반화는 상관 관계의 이행성(transtivity)에 기반하고 결코 또는 거의 발생하지 않은 새로운 변수 조합을 탐구한다. 암기에 근거한 추천은 보통 사용자가 이미 행동을 취했던 품목과 직접적으로 관련되어 있다. 암기와 비교할 때, 일반화는 추천 품목 다양성을 향상시키는 경향이 있다. 이 글에서는 Google Play 스토어 앱 추천 문제에 초점을 맞추지만 추천 시스템에 일반적으로 적용해볼 수 있다.
  
기업 내 거대 규모의 온라인 추천 및 순위 시스템에선 로지스틱 회귀 같은 일반화된 선형 모형이 간단하고 확장 가능하며 해석하기 쉽기 때문에 널리 사용된다. 종종 one-hot 인코딩을 사용하여 이진화한 희소 변수에 대해 모형 훈련을 진행한다. 예를 들자면 이진값 변수 "user_installed_app = netflix"는 사용자가 Netflix를 설치한 경우 값 1을 가진다. 암기는 AND(user_installed_app = netflix, impression_app = pandora)와 같은 교차곱 변수 변환을 사용하면 효과적으로 얻어낼 수 있다. 사용자가 Netflix를 설치했고 이후 Pandora가 노출됐으면 값은 1이다. 이는 변수 쌍의 동시 발생이 목표 레이블과 어떻게 연관되는지를 설명해준다. AND(user_installed_category = video, impression_category = music) 같이 덜 세분화된 변수를 사용해서 일반화할 수 있지만 수작업 피쳐 엔지니어링이 종종 필요하다. 교차곱 변수 변환의 한 가지 한계는 훈련 데이터에 나타나지 않은 질의 품목 변수 쌍을 일반화하진 못한다는 것이다.
  
인수 분해 기반의 모델 (예 : 인수 분해 기계 또는 심층 신경망)은 피쳐 엔지니어링에 대한 부담을 줄이면서 쿼리 및 항목 기능마다 저 차원 밀도 임베딩 벡터를 학습하여 이전에 보이지 않는 쿼리 항목 피쳐 쌍을 일반화 할 수 있습니다. 그러나 기본 쿼리 항목 행렬이 특정 선호도를 가진 사용자 또는 호소력이 좁은 틈새 품목과 같이 상위 및 하위 순위 일 때 쿼리 및 항목에 대한 효과적인 저 차원 표현을 배우는 것은 어렵습니다. 그런 경우에, 거기
대부분의 질의 - 항목 쌍들 사이의 상호 작용이 없어야하지만 밀집된 삽입은 모든 질의 - 항목 쌍에 대해 0이 아닌 예측을 유도 할 것이며, 따라서 과도하게 일반화되고 덜 관련성있는 권고를 할 수있다. 반면, 제품 간 피처 변환이있는 선형 모델은 훨씬 적은 수의 매개 변수로 이러한 "예외 규칙"을 기억할 수 있습니다.
  

본 논문에서는 그림 1과 같이 선형 모델 구성 요소와 신경망 구성 요소를 공동으로 학습하여 한 모델에서 암기 및 일반화를 모두 달성 할 수있는 Wide & Deep 학습 프레임 워크를 제시합니다.
  
이 논문의 주요 공헌 내용은 다음과 같습니다.
* 희소 입력이있는 일반 추천 시스템에 대한 피쳐 변환을 사용하여 피딩 - 포워드 신경 네트워크와 임베딩 및 선형 모델을 공동으로 교육하기위한 와이드 & 딥 학습 프레임 워크.
* 10 억 명이 넘는 활성 사용자와 100 만 개가 넘는 앱이있는 모바일 앱 스토어 인 Google Play에서 생산되는 Wide & Deep 추천 시스템의 구현 및 평가.
* 우리는 TensorFlow의 높은 수준의 API와 함께 구현을 오픈 소스했습니다.^[1]
아이디어는 간단하지만 Wide & Deep 프레임 워크는 모바일 앱 스토어의 앱 획득 속도를 크게 향상시키는 동시에 교육 및 서빙 속도 요구 사항.

[^1]: See Wide & Deep Tutorial on http://tensorflow.org.
