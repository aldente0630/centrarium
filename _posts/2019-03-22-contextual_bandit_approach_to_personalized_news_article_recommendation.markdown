---
layout: post
title: 뉴스 기사 개인화 추천을 위한 컨텍스츄얼 밴딧 접근법
date: 2019-03-22 00:00:00
author: Yahoo! Labs, Princeton University
categories: Data-Science
---  
  
  
**Lihong Li, Wei Chu, John Langford, Robert E. Schapire의 [*A Contextual-Bandit Approach to Personalized News Article Recommendation*](http://rob.schapire.net/papers/www10.pdf)을 번역했습니다.**
  
  
- - -

# 초록
  
개인화 웹 서비스는 컨텐츠 및 사용자 정보를 이용해서 개별 사용자마다 (광고, 뉴스 기사 등의) 맞춤 서비스를 제공하기 위해 노력한다. 최신 기술의 발전에도 불구하고 적어도 두 가지 이유로 난항을 여전히 겪고 있다. 먼저, 웹 서비스의 경우 기존 협업 필터링 방법을 적용하기 어려울만큼 동적으로 변하는 컨텐츠 풀을 특징으로 한다. 둘째, 실용적으로 자주 쓰이는 웹 서비스의 규모는 학습과 계산 모든 면에서 고속인 해법을 필요로 한다.  
  
본 논문은 뉴스 기사 개인화 추천을 어떤 원리적 접근법, 컨텍스츄얼 밴딧 문제로 모형화한다. 컨텍스츄얼 밴딧은 사용자 클릭 수 총합을 극대화하기 위해 사용자 클릭 피드백을 바탕으로 기사 선택 전략을 점차 수정해 나가는 동시에 사용자와 기사에 관한 맥락 상 정보를 기반으로 사용자에게 제공할 기사를 순차적으로 선택하는 학습 알고리즘이다.  
  
이 논문이 공헌하는 바는 세 가지이다. 첫째, 계산이 효율적이며 학습 이론에서 동기를 얻은, 새롭고 일반화 가능한 컨텍스츄얼 밴딧 알고리즘을 제안한다. 둘째, 이전에 기록된 무작위 트래픽을 이용하여 모든 밴딧 알고리즘을 *오프라인에서* 안정적으로 평가할 수 있는 방법을 이야기한다. 마지막으로 해당 오프라인 평가 방법을 통해 3,300만 건이 넘는 이벤트가 포함된 Yahoo! Front Page Today 데이터셋에 새 알고리즘을 성공적으로 적용했다. 결과에 따르면 기존의 맥락 무관한 밴딧 알고리즘과 비교했을 때 클릭 수준을 12.5 % 넘게 끌어올렸고 이러한 이점은 데이터가 부족할수록 더욱 커진다.
  
# 1. 서론
  
본 논문은 각 사용자 별로 가장 적절한 웹 기반 컨텐츠를 가장 적절한 시기에 선별해내는 문제를 해결한다. 대부분의 서비스 공급 업체는 예를 들어 뉴스 기사를 필터링하거나 광고를 띄우기 위해 저장소에 다량의 컨텐츠를 확보하고 유지 관리한다. 또한 그러한 웹 서비스 저장소의 컨텐츠는 빈번한 추가 및 삭제를 거치면서 동적으로 변한다. 이러한 환경에서 사용자가 흥미를 가질 컨텐츠를 신속히 선정해내는게 중요하다. 예를 들자면 뉴스 필터는 인기있는 속보를 즉시 판별해내는 동시에 시간이 흐른, 기존 뉴스 기사의 가치는 감가시켜야한다.  
  
컨텐츠 정보 만으로 인기와 시간에 따른 변화를 모형화하는건 일반적으로 어렵다. 보통 실무에서는 신규 컨텐츠의 인기를 평가하기 위해 소비자 피드백을 실시간으로 수집해 미지의 것을 탐색해봄과 함께 기존 가치의 변화를 추적, 관찰해나간다. 예를 들어 트래픽 일부를 그러한 탐색을 위해 배정할 수 있다. 무작위로 고른 컨텐츠에 대한 트래픽 일부의 사용자 응답(예: 클릭)을 기반으로 가장 애용되는 컨텐츠를 판별해서 이를 나머지 트래픽에 활용해볼 수 있다. 트래픽 중 ε만큼의 부분은 무작위로 탐색하고 나머지에 대해 탐욕적 활용을 수행하는 해당 전략을 **ε-탐욕적**이라고 부른다. **EXP3**이나 **UCB1**과 같이 진보한 탐색 접근법도 사용해볼 수 있다. 직관적으로 신규 컨텐츠의 경우 더 많은 트래픽을 배정해서 가치를 빨리 학습해야하고 기존 컨텐츠의 경우 추이를 파악하기 위한 사용자 수는 점차 줄여 나가야한다.
  
최근 개인화 추천은 웹 사이트가 개별 사용자 요구에 맞게 컨텐츠 표현을 조정하여 사용자 만족도를 향상시키는 용도로써 훌륭히 잘 쓰이고 있다. 개인화는 사용자 속성을 수집, 저장하고 컨텐츠 자산을 관리하며 현재와 과거 사용자 행동을 분석하여 가장 적합한 컨텐츠를 현 사용자에게 개별적으로 제공하는 절차를 포함한다.
  
사용자와 컨텐츠는 흔히 변수의 집합으로 표현된다. 사용자 변수에는 기입된 인구 통계 정보뿐만 아니라 활동 기록을 집계한 걸 포함시킬 수 있다. 컨텐츠 변수에는 설명 정보와 범주를 포함시킬 수 있다. 지금 다루는 시나리오의 경우 똑같은 컨텐츠에 대해 사용자마다 관점이 상당히 다를 수 있기 때문에 탐색과 활용이 개별적으로 수행되어야한다. 매우 많은 숫자의 선택지 또는 동작이 존재할 수 있으므로 컨텐츠 품목 간의 공통점을 인지하여 컨텐츠 풀로 해당 지식을 전달할 수 있는지도 중요하다.
  
협업 필터링, 컨텐츠 기반 필터링 또는 혼합 접근법을 포함하여 기존 추천 시스템은 과거 활동을 통해 판별한 사용자 관심사를 이용하여 개인 수준에서 의미있는 추천을 제공한다. 사용자 간 소비 이력이 상당히 겹치고 컨텐츠 전체 목록이 잘 변하지 않는 시나리오라면 협업 필터링이 사용자 소비 이력을 기반으로 유사도를 계산하여 좋은 추천안을 제공할 수 있다. 컨텐츠 기반 필터링의 경우 기존 사용자의 소비 프로필과 잘 부합하는 신규 품목을 식별하는데 용이하지만 추천한 품목이 사용자가 이전에 취해온 품목들과 굉장히 유사할 수 밖에 없다. 혼합 접근법은 추천 기법을 두 가지 이상 결합하여 개발한다. 예를 들어 협업 필터링은 신규 품목을 추천할 수 없는데 보통 컨텐츠 기반 필터링과 결합하여 이 약점을 보완한다.  
  
그러나 위에서 언급했듯이 대부분의 웹 기반 시나리오에서 컨텐츠 전체 목록은 자주 변경되며 시간이 경과함에 따라 컨텐츠의 인기는 변한다. 또한 방문자의 상당수는 과거 소비 기록이 전혀 없는 신규 사용자들인데 이는 보통 *콜드 스타트* 상황으로 불리운다. 앞서 언급한 문제들은 과거 사례 연구에서 볼 수 있듯이 추천 시스템의 전통적인 접근법을 적용하기 어렵게 만든다. 따라서 사용자와 컨텐츠 중 한쪽 또는 양쪽 모두 새로 등장한 것이라면 서로 잘 부합하는 지 학습하는 과정이 필수이다. 그러나 해당 정보를 수집하는 건 비용이 많이 들고 사용자 만족도를 단기적으로 저하시킬 수 있다. 그러므로 장기적인 사용자 만족도를 극대화시키고 사용자의 관심사와 컨텐츠가 잘 부합하는지 정보를 수집하는, 상충하는 두 가지 목표 간에 최적 균형점을 찾는 문제로 이어진다.
   
윗 문제는 사실 변수 기반의 탐색 / 활용 문제로 알려져있다. 본 논문은 이를 어떤 원리적 접근법, *컨텍스츄얼 밴딧* 문제로 수식화한다. 컨텍스츄얼 밴딧은 사용자 클릭 수 총합을 장기적으로 극대화하기 위해 사용자 클릭 피드백을 바탕으로 기사 선택 전략을 점차 수정해 나가는 동시에 사용자와 기사에 관한 맥락 상 정보를 기반으로 사용자에게 제공할 기사를 순차적으로 선택하는 학습 알고리즘이다. 2장에서는 다중 슬롯머신 실험 문제를 정의하고 기존의 접근법을 검토한다. 그리고 3장에서 새로운 알고리즘 **LinUCB**를 제안한다. 해당 알고리즘의 경우 적은 계산량으로 최적 선형 예측기에 견주기 위해 가장 잘 알려진 알고리즘 기준으로 유사 리그릿 분석을 수행한다. 또 4장은 *오프라인* 평가 방법론을 다루면서 각 상호 작용이 독립이고 분포가 동일하다면(i.i.d.) *모든* 탐색 / 활용 전략에 해당 전략을 적용할 수 있음을 증명한다. 서로 다른 사용자를 고려할 때 이는 합리적인 가정일 수 있다. 마지막으로 5장은 해당 오프라인 평가 전략을 사용하여 새 알고리즘과 기존 알고리즘을 실험한다.
   
# 2. 수식화와 연관 작업
  
이 장은 \\(K\\)개의 슬롯 손잡이를 갖는 컨텍스츄얼 밴딧 문제를 수식으로 정의하고 이것을 뉴스 기사 개인화 추천 문제에 어떻게 적용할 수 있는지 보인다. 그런 다음 기존 방법과 그 한계점을 논한다.

## 2.1 다중 슬롯머신 실험 문제 수식화

뉴스 기사 개인화 추천 문제는 자연스럽게 맥락 상의 정보가 있는 다중 슬롯머신 문제로 모형화할 수 있다. 이전 연구에 따라 이를 *컨텍스츄얼 밴딧*[^1]이라고 부를 것이다. 수식화해보자면 컨텍스츄얼 밴딧 알고리즘 \\(\mathsf{A}\\)는 개별 시도 \\(t = 1, 2, 3, \ldots \\)에 따라 수행된다. \\(t\\)번째 시도에 대하여,
  
1.알고리즘은 현재 사용자 \\(u_t\\)와 슬롯 손잡이 또는 행동의 집합 \\(\mathcal{A}_t\\)와 함께 \\(a \in \mathsf{A}\\)일 때의 변수 벡터 \\(\mathbf{x}_{t, a}\\)를 관측한다. 벡터 \\(\mathbf{x}_{t, a}\\)는 사용자 \\(u_t\\)와 슬롯 손잡이 \\(a\\)의 정보를 *모두* 축약하며 이를 *맥락*이라고 칭한다.
2.이전 시도들에서 관측한 손익에 기초하여 \\(\mathsf{A}\\)는 슬롯 손잡이 \\(a_t \in \mathsf{A}\\)를 선택하고 해당 기대값이 사용자 \\(u_t\\)와 슬롯 손잡이 \\(a_t\\) 모두에 의존하는 손익 \\(r_{t, a_t}\\)를 받는다.
  
(번역 중)

[^1]: 문헌에 따라 때론 컨텍스츄얼 밴딧은 공변량을 갖는, 부가적 정보가 있는, 또는 연관성 있는 다중 슬롯머신 실험 아니면 연관성 있는 강화 학습이라고 불리운다.
