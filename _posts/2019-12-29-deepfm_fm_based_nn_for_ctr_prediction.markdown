---
layout: post
title: DeepFM, CTR 예측을 위한 신경망 기반 팩토라이제이션 머신
date: 2019-12-29 00:00:00
author: Harbin Institute of Technology, Huawei
categories: Data-Science
---  
  
  
**Huifeng Guo, Ruiming Tang, Yunming Ye, Zhenguo Li, Xiuqiang He의 [*DeepFM: A Factorization-Machine based Neural Network for CTR Prediction*](https://arxiv.org/pdf/1703.04247.pdf)을 번역했습니다.**
  
  
- - -
  
# 초록
  
추천 시스템의 CTR을 최대화하려면 사용자 행동에 담긴, 변수 간 복잡한 상호 작용을 학습하는 것이 중요하다. 장족의 발전이 있었지만 기존 방법들은 여전히 저차 또는 고차 상호 작용에 대한 편향이 크거나 전문적인 특성 공학 작업을 필요로 한다. 본 논문은 변수 간 저차와 고차 상호 작용 모두에 중점을 두는 종단 간 학습 모형을 도출해낸다. 제안한 모형 DeepFM은 팩토라이제이션 머신의 추천 성능과 신경망 구조를 통해 변수 학습하는 심층 학습 기법을 결합한다. Google의 Wide & Deep 최신 모형과 비교할 때 DeepFM은 "넓은"과 "깊은" 부분이 입력을 공유하며 원천 변수 외에 특성 공학이 따로 필요없다. 기존 CTR 예측 모형 대비 DeepFM 효과와 효율성을 입증하기 위해 벤치 마크 데이터와 상용 데이터 모두를 이용해 종합 실험을 수행했다.
  
# 1. 서론
  
사용자가 추천 품목을 클릭할 확률을 추정해야 하는 추천 시스템에서 CTR(Click-Through Rate) 예측은 중요하다. 대다수 추천 시스템 목표는 클릭 수를 최대화하는 것이므로 사용자에게 반환되는 항목의 예상 CTR을 기준으로 순위를 지정할 수 있다. 온라인 광고와 같은 다른 응용 시나리오에서는 수익을 향상시키는 것도 중요하므로 순위 전략은 모든 후보자에 대해 CTR × bid로 조정될 수 있습니다. 여기서 "bid"는 품목이 사용자가 클릭합니다. 두 경우 모두 키가 CTR을 정확하게 추정하는 것이 확실합니다.
  
CTR 예측에서 사용자 클릭 행동에 대한 암시 적 기능 상호 작용을 배우는 것이 중요합니다. 주류 앱 시장에서 실시한 연구에 따르면 사람들은 식사 시간에 음식 배달을 위해 앱을 다운로드하는 경우가 많으므로 앱 카테고리와 타임 스탬프 간의 (주문 2) 상호 작용이 CTR의 신호로 사용될 수 있음을 시사합니다 . 두 번째 관찰로, 슈팅 게임 및 RPG 게임과 같은 10 대 남성은 앱 카테고리, 사용자 생성 및 연령의 (3 차) 상호 작용이 CTR의 또 다른 신호임을 의미합니다. 일반적으로 사용자 클릭 동작 뒤에있는 이러한 기능의 상호 작용은 매우 정교 할 수 있으며, 여기서는 하위 및 상위 기능 상호 작용이 중요한 역할을 수행해야합니다. 구글의 Wide & Deep 모델의 통찰에 따르면, 저차 및 고차 피처 상호 작용을 *동시에* 고려하면 혼자 고려하는 경우에 비해 추가적인 개선이 이루어집니다.
  
주요 과제는 기능 상호 작용을 효과적으로 모델링하는 것입니다. 일부 기능 상호 작용은 쉽게 이해할 수 있으므로 전문가가 위의 예와 같이 설계 할 수 있습니다. 그러나 대부분의 다른 피처 상호 작용은 데이터에 숨겨져 있으며. *선험적으로* 식별하기가 어렵습니다 (예를 들어, 고전적인 연관 규칙 "기저귀 및 맥주"는 전문가가 발견하지 않고 데이터에서 채굴 됨). 기계 학습에 의해 이해하기 쉬운 상호 작용의 경우에도, 특히 기능 수가 많은 경우 전문가가 철저하게 모델링하지 않을 것 같습니다.
  
단순함에도 불구하고 FTRL과 같은 일반화 된 선형 모델은 실제로 성능이 우수했습니다. 그러나 선형 모델에는 형상 상호 작용을 학습 할 수있는 능력이 없으며, 일반적인 방법은 기능 벡터에 쌍별 형상 상호 작용을 수동으로 포함하는 것입니다. 이러한 방법은 고차원 피쳐 상호 작용을 모델링하거나 훈련 데이터에 전혀 또는 거의 나타나지 않는 것을 일반화하기 어렵습니다. 인수 분해기 (FM) Rendle은 특징들 사이에 잠재 벡터의 내적 산물로서 쌍별 특징 상호 작용을 모델링하고 매우 유망한 결과를 보여준다. FM은 원칙적으로 고차 피쳐 상호 작용을 모델링 할 수 있지만 실제로는 복잡도가 높기 때문에 실제로 차수 2 피쳐 상호 작용 만 고려됩니다.
  
특징 표현 학습에 대한 강력한 접근법으로서, 딥 뉴럴 네트워크는 정교한 특징 상호 작용을 배울 수있는 잠재력을 가지고 있습니다. 일부 아이디어는 CTR 예측을 위해 CNN 및 RNN을 확장합니다 [Liu et al., 2015; Zhang et al., 2014], 그러나 CNN 기반 모델은 인접 기능 간의 영향에 편향되어 있으며 RNN 기반 모델은 순차적 인 종속성이있는 클릭 데이터에 더 적합합니다. [Zhang et al., 2016]은 연구를 특징으로하고 인수 분해 기계 지원 신경망 (FNN)을 제안합니다. 이 모델은 DNN을 적용하기 전에 FM을 사전 훈련하므로 FM 기능에 의해 제한됩니다. 기능 상호 작용은 [Qu et al., 2016]에서 임베딩 계층과 완전히 연결된 계층 사이에 제품 계층을 도입하고 PNN (Product-based Neural Network)을 제안함으로써 연구됩니다. [Cheng et al., 2016]에서 언급했듯이 PNN과 FNN은 다른 심층 모델과 마찬가지로 CTR 예측에 필수적인 하위 특징 상호 작용이 거의 없습니다. 저차 및 고차 피처 상호 작용을 모델링하기 위해 [Cheng et al., 2016]은 선형 ( "와이드") 모델과 딥 모델을 결합한 흥미로운 하이브리드 네트워크 구조 (Wide & Deep)를 제안합니다. 이 모델에서는“와이드 파트”와“딥 파트”에 각각 두 개의 다른 입력이 필요하며“와이드 파트”의 입력은 여전히 전문 기술 엔지니어링에 의존합니다.
