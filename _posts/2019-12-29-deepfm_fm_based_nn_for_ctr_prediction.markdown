---
layout: post
title: DeepFM, CTR 예측을 위한 신경망 기반 팩토라이제이션 머신
date: 2019-12-29 00:00:00
author: Harbin Institute of Technology, Huawei
categories: Data-Science
---  
  
  
**Huifeng Guo, Ruiming Tang, Yunming Ye, Zhenguo Li, Xiuqiang He의 [*DeepFM: A Factorization-Machine based Neural Network for CTR Prediction*](https://arxiv.org/pdf/1703.04247.pdf)을 번역했습니다.**
  
  
- - -
  
# 초록
  
추천 시스템의 CTR을 극대화하려면 사용자 행동에 담긴, 변수 간 복잡한 상호 작용을 학습하는 것이 중요하다. 장족의 발전이 있었지만 기존 방법들은 여전히 저차 또는 고차 상호 작용에 대한 편향이 크거나 전문적인 특성 공학 작업을 필요로 한다. 본 논문은 변수 간 저차와 고차 상호 작용 모두에 중점을 두는 종단 간 학습 모형을 도출해낸다. 제안한 모형 DeepFM은 팩토라이제이션 머신의 추천 성능과 신경망 구조를 통해 변수 학습하는 심층 학습 기법을 결합한다. Google의 Wide & Deep 최신 모형과 비교할 때 DeepFM은 "넓은"과 "깊은" 부분이 입력을 공유하며 원천 변수 외에 특성 공학이 따로 필요없다. 기존 CTR 예측 모형 대비 DeepFM 효과와 효율성을 입증하기 위해 벤치 마크 데이터와 상용 데이터 모두를 이용해 종합 실험을 수행했다.
  
# 1. 서론
  
추천한 품목을 사용자가 클릭할지 확률을 추정해야 하는 추천 시스템에서 CTR(Click-Through Rate) 예측은 중요하다. 대다수 추천 시스템의 목표는 클릭 수를 극대화하는 것으로 사용자에게 노출할 품목은 추정 CTR을 기준으로 순위를 지정할 수 있다. 온라인 광고와 같은 다른 애플리케이션 시나리오에서는 수익 향상이 중요하므로 순위 전략은 광고 후보에 대한 CTR × 입찰가 기준으로 조정할 수 있다. 여기서 "입찰가"가 사용자가 품목을 클릭할 경우 광고 시스템이 받는 수익이 된다. 두 경우 모두 CTR을 정확히 추정하는것이 핵심이다.
  
CTR 예측에서 사용자 클릭 행동에 담긴, 변수 간 암시적 상호 작용을 학습하는 것이 중요하다. 주요 앱 시장에 대해 연구한 바에 따르면 사람들은 식사 시간에 음식 배달을 위해 해당 앱을 다운로드하는 경우가 많다. 이는 앱 카테고리와 시간대 간의 (2차) 상호 작용을 CTR 예측 신호로 사용할 수 있음을 의미한다. 두 번째 사례로 슈팅 게임과 RPG를 좋아하는 10대 남성의 경우 앱 카테고리, 사용자 성별과 연령의 (3차) 상호 작용이 CTR의 또 다른 예측 신호임을 의미한다. 일반적으로 사용자 클릭 동작에 담긴 이러한 변수 간 상호 작용은 매우 복잡할 수 있으며 변수 간 저차와 고차 상호 작용 모두 중요한 역할을 한다. Google의 Wide & Deep 모형 연구에 따르면 변수 간 저차와 고차 상호 작용을 *동시에* 고려할 때 단독의 경우 대비 추가 성능 개선이 이뤄진다.
  
주요 과제는 변수 간 상호 작용을 효과적으로 모델링하는 것이다. 변수 간 상호작용 중 일부는 쉽게 이해 가능하며 위의 예처럼 전문가가 직접 설계할 수 있다. 그러나 변수 간 상호작용의 대부분은 데이터에 숨겨져 있어 *선험적으로* 알아내긴 어렵고(예를 들어 그 유명한 연관 규칙 "맥주와 기저귀"를 전문가가 발견한게 아니라 데이터 마이닝 기법으로 찾아냈듯이) 기계학습을 통해 *자동적으로* 잡아낼 수 있다. 설령 이해하기 쉬운 상호작용이라고 하더라도 변수 개수가 많다면 전문가가 제대로 모델링하긴 어려울 것이다.
  
FTRL 같은 일반화 선형 모형의 경우 단순하지만 실제 성능은 뛰어나다. 그러나 선형 모형은 변수 간 상호 작용을 학습하지 못하기 때문에 보통은 변수 벡터에 변수 쌍의 상호 작용을 수동으로 포함시킨다. 이 방법은 변수 간 고차 상호 작용, 아니면 훈련 데이터에 전혀 또는 거의 나타나지 않은 것을 모델링하여 일반화하기 어렵다. *Factorization Machines(FM)* 은 변수 간 잠재 벡터의 내적으로 변수 쌍의 상호 작용을 모델링하며 매우 훌륭한 결과를 보여준다. 이론적으로 FM은 변수 간 고차 상호 작용까지 모델링할 수 있지만 복잡도가 매우 높아지기 때문에 실제로는 변수 간 2차 상호 작용만 고려한다.
  
특징 표현 학습에 대한 강력한 접근법으로서, 딥 뉴럴 네트워크는 정교한 특징 상호 작용을 배울 수있는 잠재력을 가지고 있습니다. 일부 아이디어는 CTR 예측을 위해 CNN 및 RNN을 확장합니다 [Liu et al., 2015; Zhang et al., 2014], 그러나 CNN 기반 모델은 인접 기능 간의 영향에 편향되어 있으며 RNN 기반 모델은 순차적 인 종속성이있는 클릭 데이터에 더 적합합니다. [Zhang et al., 2016]은 연구를 특징으로하고 인수 분해 기계 지원 신경망 (FNN)을 제안합니다. 이 모델은 DNN을 적용하기 전에 FM을 사전 훈련하므로 FM 기능에 의해 제한됩니다. 기능 상호 작용은 [Qu et al., 2016]에서 임베딩 계층과 완전히 연결된 계층 사이에 제품 계층을 도입하고 PNN (Product-based Neural Network)을 제안함으로써 연구됩니다. [Cheng et al., 2016]에서 언급했듯이 PNN과 FNN은 다른 심층 모델과 마찬가지로 CTR 예측에 필수적인 하위 특징 상호 작용이 거의 없습니다. 저차 및 고차 피처 상호 작용을 모델링하기 위해 [Cheng et al., 2016]은 선형 ( "와이드") 모델과 딥 모델을 결합한 흥미로운 하이브리드 네트워크 구조 (Wide & Deep)를 제안합니다. 이 모델에서는“와이드 파트”와“딥 파트”에 각각 두 개의 다른 입력이 필요하며“와이드 파트”의 입력은 여전히 전문 기술 엔지니어링에 의존합니다.
  
기존 모델이 오더 또는 오더 피처 상호 작용에 편향되어 있거나 피처 엔지니어링에 의존하고 있음을 알 수 있습니다. 이 백서에서는 원시 피처 외에 피처 엔지니어링없이 모든 주문의 피처 상호 작용을 엔드 투 엔드 방식으로 학습 할 수있는 학습 모델을 도출 할 수 있음을 보여줍니다. 우리의 주요 기여는 다음과 같이 요약됩니다.
  
* FM과 DNN (deep neural network)의 아키텍처를 통합하는 새로운 신경망 모델 DeepFM (그림 1)을 제안합니다. FM과 같은 하위 기능 상호 작용을 모델링하고 DNN과 같은 상위 기능 상호 작용을 모델링합니다. Wide & Deep 모델 [Cheng et al., 2016]과 달리 DeepFM은 기능 엔지니어링없이 종단 간 교육을받을 수 있습니다.
  
* DeepFM은 [Cheng et al., 2016]과 달리 넓은 부분과 깊은 부분이 동일한 입력과 임베딩 벡터를 공유하므로 효율적으로 학습 할 수 있습니다. [Cheng et al., 2016]에서 입력 벡터는 넓은 부분의 입력 벡터에 수동으로 설계된 페어 와이즈 피처 상호 작용을 포함하기 때문에 크기가 클 수 있으므로 복잡성이 크게 증가합니다.

* 벤치 마크 데이터와 상업 데이터 모두에서 DeepFM을 평가하여 CTR 예측을 위해 기존 모델보다 일관된 개선을 보여줍니다.
