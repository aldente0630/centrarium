---
layout:     post
title:      Practical Lessons from Predicting Clicks on Ads at Facebook
date:       2018-05-10 00:00:00
author:     Facebook
categories: Data-Science
---  
  
  
**Xinran He, Junfeng Pan, Ou Jin, Tianbing Xu, Bo Liu, Tao Xu, Yanxin Shi, Antoine Atallah, Ralf Herbrich, Stuart Bowers, Joaquin Quiñonero Candela의 [*Practical Lessons from Predicting Clicks on Ads at Facebook*](http://quinonero.net/Publications/predicting-clicks-facebook.pdf)을 번역했습니다.**
  
  
- - -
  
## 초록
  
온라인 광고에서 광고주는 광고 클릭 같이 측정가능한 사용자 응답에 대해 입찰하며 대금을 지불한다. 그러므로 클릭 예측 시스템은 온라인 광고 시스템의 핵심이다. 매일 활동중인 7억 5천만명 이상의 사용자와 1백만명 이상의 유효 광고주를 고려할 때 페이스북 광고 클릭을 예측하는 일은 상당히 어려운 기계학습 작업이다. 이 논문은 결정 트리와 로지스틱 회귀를 결합한 모형을 소개하며 해당 모형은 시스템 성능에 전반적으로 큰 영향을 미치면서 결정 트리 또는 로지스틱 회귀 하나만 사용한 것보다 예측 성능을 3% 이상 향상시켰다. 다음으로 몇 개의 기본 매개 변수가 시스템 최종 예측 성능에 미치는 영향을 조사했다. 당연한 말이지만 가장 중요한 건 적절한 변수를 찾는 일이다. 사용자나 광고 이력 정보를 담은 변수는 다른 유형의 변수보다 훨씬 중요하다. 적절한 변수와 적절한 모형(의사 결정 트리 및 로지스틱 회귀)을 갖춘 다음에야 다른 요인들이 작게 기여한다(개선폭이 작더라도 규모 확장을 고려한다면 중요하다). 데이터 신선도, 학습률 스키마와 데이터 샘플링에 대해 최적 처리 방법을 적용하면 모형 성능을 다소 향상시킬 수 있으나 매우 값진 변수를 추가하거나 적절한 모형을 처음부터 선택하는 것보다 그 정도는 훨씬 못하다.
  
## 1. 개론
  
디지털 광고 업계는 수십억 달러 규모이며 매년 급격히 커지고 있다. 대부분의 온라인 광고 플랫폼에서는 광고를 동적으로 할당하며 사용자 관심도에 따라 조정한다. 사용자에 대한 광고 후보의 예상 효용을 계산하는 일에 기계학습이 중점적인 역할을 하며 이런 방식으로 시장 효율성이 높아진다.
  
Varian 또는 Edelman 등이 쓴 2007년 논문은 Google과 Yahoo!가 개척한 클릭마다 입찰하고 지불하는 경매 시스템을 설명한다. 같은 해 Microsoft는 동일한 경매 모형을 기반으로 스폰서 검색 시장을 구축했다. 광고 입찰의 효율성은 클릭 예측의 정확도 및 세밀한 조정에 달려있다. 클릭 예측 시스템은 견고하고 적응력이 있어야하며 대량의 데이터를 학습할 수 있어야한다. 본 논문의 목표는 이런 요구 사항을 염두에 두고 실제 데이터로 수행한 실험에서 얻은 통찰을 공유하는 일이다.
  
스폰서 검색 광고는 사용자 질의를 명시적 또는 암시적으로 질의와 일치하는 광고 후보를 검색하는 데 사용한다. Facebook은 광고를 검색어와 연결하진 않았지만 인구 통계 및 관심 분야로 타겟팅을 한다. 따라서 사용자가 Facebook을 방문할 경우 표시 가능한 광고의 양은 스폰서 검색보다 많을 수 있다.
  
사용자가 Facebook을 방문할 때 광고 게재가 요청되며 요청마다 매우 많은 수의 광고 후보를 처리해야 하기 때문에 먼저 연속되는 분류기를 계산 비용이 증가하는 순으로 만든다. 이 논문은 연속되는 분류기 중 마지막 단계이자 광고 최종 후보군에 대해 예측하는 클릭 예측 모형에 대해 중점적으로 설명한다.
  
결정 트리와 로지스틱 회귀를 결합한 하이브리드 모형은 그 중 하나만 사용한 것보다 예측 성능을 3% 이상 향상시킨다. 이 개선폭은 전체 시스템 성능에 중대한 영향을 미친다. 몇 개의 기본 매개 변수가 시스템 최종 예측 성능에 영향을 미친다. 예상대로 가장 중요한 건 적절한 변수를 찾는 일이다. 사용자나 광고 기록 정보를 담은 변수는 다른 유형의 변수보다 훨씬 중요하다. 적절한 변수와 적절한 모형(의사 결정 트리와 로지스틱 회귀)을 갖춘 다음에야 다른 요인들이 작게 기여한다.(개선폭이 작더라도 규모 확장을 고려한다면 중요하다). 데이터 신선도, 학습률 스키마와 데이터 샘플링에 대해 최적 처리 방법을 적용하면 모형 성능을 다소 향상시킬 수 있으나 매우 값진 변수를 추가하거나 적절한 모형을 처음부터 선택하는 것보다 그 정도는 훨씬 못하다.
  
2장은 실험 설정에 대한 개요로 시작한다. 3장에서는 여러 가지 확률론적 선형 분류기와 다양한 온라인 학습 알고리즘을 평가한다. 변수 변환과 데이터 신선도 영향을 평가하기 위해 선형 분류 관련 내용을 계속 진행할 것이다. 꽤 작은 크기의 모형을 만들면서 데이터 신선도와 온라인 학습 관련한 실제 결과에 영감을 특히 얻어 온라인 학습 계층을 통합한 모형 아키텍처를 제시할 것이다. 4장에서는 온라인 학습 계층의 핵심 구성 요소이자 실시간 훈련 데이터의 실시간 스트림을 생성시킬 수 있는 인프라 속 실험적인 부분, 즉 온라인 접합부에 대해 설명한다.
  
마지막으로 메모리와 정확도를 교환하여 시간을 계산하고 엄청난 양의 훈련 데이터를 다룰 수 있는 방법을 제시한다. 5장은 방대한 규모의 응용 프로그램이 갖고있는 메모리와 대기 시간을 유지시키는 실용적인 방법을 설명하고 6장에서는 훈련 데이터 양과 정확도 사이 균형 관계를 조사한다.
  
## 2. 실험 설정
  
엄격하고 통제된 실험을 수행하기 위해 2013년 4분기 중 한 주를 임의로 선택하여 오프라인 훈련 데이터 준비를 했다. 동일한 훈련 및 테스트 데이터를 상이한 조건에서 가져가기 위해 온라인에서 관측한 것과 비슷하게 오프라인 훈련 데이터를 준비했다. 저장한 오프라인 데이터를 훈련과 테스트 용으로 분할하여 온라인 교육과 예측을 위한 스트리밍 데이터로 시뮬레이션했다. 이 논문의 모든 실험에 동일한 교육/테스트 데이터를 테스트베드로 이용했다.
  
**평가 척도:** 기계 학습 모형에 영향을 주는 요인에 대해 가장 큰 관심이 있기에 이익과 수익에 직접 관련된 지표 대신 예측 정확도를 사용한다. 본 작업에서는 표준화 엔트로피(NE)와 조정을 주요 평가 척도로 사용한다.
